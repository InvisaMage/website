<!DOCTYPE html>

<!--Achievements Modal-->
<div class="modal-dialog modal-sm" id="ajax-achievements">
  <div class="modal-content">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <h4 class="modal-title black">Achievements</h4>
    </div>
    <div class="modal-body">
      <!--local-warning-banner-->
      <div id="local-warning-banner" class="alert alert-danger fade in text-center" role="alert">
        <strong>*Warning*</strong><br>
        <span id="local-warning-banner-content">
          Something is wrong if you are seeing this.
        </span>
    	</div><!--./local-warning-banner-->
      <table class="table table-responsive table-condensed table-hover">
        <!--Header-->
        <tr>
          <td><h5 class="black-bold">Name</h5></td>
          <th><h5 class="black-bold">Achieved</h5></th>
        </tr>
        <!--Konami-->
        <tr class="not-active" id="eastereggRow">
          <td><h5 class="black">Konami Code</h5></td>
          <th><h5 class="text-danger" id="eastereggAchievement">No</h5></th>
        </tr>
        <!--Terminal-->
        <tr class="not-active" id="terminalRow">
          <td><h5 class="black">Hacker?!</h5></td>
          <th><h5 class="text-danger" id="terminalAchievement">No</h5></th>
        </tr>
        <!--Wisely-->
        <tr class="not-active" id="wiselyRow">
          <td><h5 class="black">Chosen Wisely</h5></td>
          <th><h5 class="text-danger" id="wiselyAchievement">No</h5></th>
        </tr>
        <!--Hallucinating-->
        <tr class="not-active" id="hallucinatingRow">
          <td><h5 class="black">Hallucinating</h5></td>
          <th><h5 class="text-danger" id="hallucinatingAchievement">No</h5></th>
        </tr>
        <!--Purple Rain-->
        <tr class="not-active" id="purplerainRow">
          <td><h5 class="black">Purple Rain</h5></td>
          <th><h5 class="text-danger" id="purplerainAchievement">No</h5></th>
        </tr>
      </table>
    </div>
    <!--Achievements Help Collapsible Content-->
    <div class="collapse" id="modal-achievements-collapse">
      <div class="well">
        <button type="button" class="close" onclick="$('#modal-achievements-collapse').collapse('toggle');" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <strong>What is this?</strong><br>
        This shows you the status of available achievements found in this site.
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-info" onclick="$('#modal-achievements-collapse').collapse('toggle');">
        <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span>
      </button>
      <button type="button" class="btn btn-primary" data-dismiss="modal"> Done
        <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
      </button>
    </div><!-- /.modal-footer -->
  </div><!-- /.modal-content -->
</div><!-- /.modal-achievements-->

<script>
  /* Allows popover activation on hover
   * Modified from http://stackoverflow.com/questions/17437818/twitter-bootstrap-popover-trigger-how-to-set-multiple-triggers#17438133
   */
  $(function () {
    var showPopover = function () {
        $(this).popover('show');
      };
      hidePopover = function () {
        $(this).popover('hide');
    };

    $('#eastereggRow, #terminalRow, #wiselyRow, #hallucinatingRow, #purplerainRow').popover({
        trigger: 'manual',
        title: 'Achievement Method',
        placement: 'right',
        container: 'body'
    })
    .focus(showPopover)
    .blur(hidePopover)
    .hover(showPopover, hidePopover);
  });

  //Check which Achievements have been completed.
  $(function() {
    //Easter Egg
    if (Cookies.get('eastereggAchievement') == 'true') {
      $("#eastereggRow").attr("class","cur-point");
      $("#eastereggRow").attr("data-toggle","popover");
      $("#eastereggRow").attr("data-content","Insert Up, Up, Down, Down, Left, Right, Left, Right, B, A anywhere in the website.");
      $("#eastereggAchievement").replaceWith("<h5 class='text-success' id='eastereggAchievement'>Yes</h5>");
      console.log('eastereggAchievement = true');
    }else {
      $("#eastereggRow").attr("class","not-active");
      $("#eastereggAchievement").replaceWith("<h5 class='text-danger' id='eastereggAchievement'>No</h5>");
      console.log('eastereggAchievement = false');
    }

    //Terminal
    if (Cookies.get('terminalAchievement') == 'true') {
      $("#terminalRow").attr("class","cur-point");
      $("#terminalRow").attr("data-toggle","popover");
      $("#terminalRow").attr("data-content","Use the Terminal for the first time.");
      $("#terminalAchievement").replaceWith("<h5 class='text-success' id='terminalAchievement'>Yes</h5>");
      console.log('terminalAchievement = true');
    }else {
      $("#terminalRow").attr("class","not-active");
      $("#terminalAchievement").replaceWith("<h5 class='text-danger' id='terminalAchievement'>No</h5>");
      console.log('terminalAchievement = false');
    }

    //Wisely
    if (Cookies.get('wiselyAchievement') == 'true') {
      $("#wiselyRow").attr("class","cur-point");
      $("#wiselyRow").attr("data-toggle","popover");
      $("#wiselyRow").attr("data-content","Agree to the Terms & Conditions or Privacy Policy.");
      $("#wiselyAchievement").replaceWith("<h5 class='text-success' id='wiselyAchievement'>Yes</h5>");
      console.log('wiselyAchievement = true');
    }else {
      $("#wiselyRow").attr("class","not-active");
      $("#wiselyAchievement").replaceWith("<h5 class='text-danger' id='wiselyAchievement'>No</h5>");
      console.log('wiselyAchievement = false');
    }

    //Hallucinating
    if (Cookies.get('hallucinatingAchievement') == 'true') {
      $("#hallucinatingRow").attr("class","cur-point");
      $("#hallucinatingRow").attr("data-toggle","popover");
      $("#hallucinatingRow").attr("data-content","Click Hide Ads in the footer.");
      $("#hallucinatingAchievement").replaceWith("<h5 class='text-success' id='hallucinatingAchievement'>Yes</h5>");
      console.log('hallucinatingAchievement = true');
    }else {
      $("#hallucinatingRow").attr("class","not-active");
      $("#hallucinatingAchievement").replaceWith("<h5 class='text-danger' id='hallucinatingAchievement'>No</h5>");
      console.log('hallucinatingAchievement = false');
    }

    //Purple Rain
    if (Cookies.get('purplerainAchievement') == 'true') {
      $("#purplerainRow").attr("class","cur-point");
      $("#purplerainRow").attr("data-toggle","popover");
      $("#purplerainRow").attr("data-content","Enable the snowstorm with the 'light' theme enabled.");
      $("#purplerainAchievement").replaceWith("<h5 class='text-success' id='purplerainAchievement'>Yes</h5>");
      console.log('purplerainAchievement = true');
    }else {
      $("#purplerainRow").attr("class","not-active");
      $("#purplerainAchievement").replaceWith("<h5 class='text-danger' id='purplerainAchievement'>No</h5>");
      console.log('purplerainAchievement = false');
    }
  });

  //Enable tooltips
  if (!('ontouchstart' in window)) {
    $('body').popover({
      selector: '[data-toggle="popover"]'
    });
  }

  //Local File Detection
  $(function(){
    $('#local-warning-banner').toggle();
    var location = window.location;
    var Slocation = String(location);

    if (Slocation.startsWith("file://")) {
      document.getElementById("local-warning-banner-content").innerHTML =
      "It looks like you are viewing this page locally. " +
      "Cookies are configured to only send on secure connections (https). " +
      "As a result, Achievements will not be saved as they require cookies to function. ";
      $('#local-warning-banner').toggle();
      console.log("Local site");
    }
    else {
      console.log("Settings will work");
    }
  });
</script>
