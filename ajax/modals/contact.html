<!DOCTYPE html>

<!--Contact Modal-->
<div class="modal-dialog modal-md" id="ajax-contact" role="document">
  <div class="modal-content">
    <div class="modal-header">
       <h4 class="modal-title">Contact</h4>
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      Questions, Comments, Suggestions, <a class="link" href="fs.html">Floating Survival</a> problems?
      <br>
      <br>
        <!--E-mail-->
        <div class="input-group">
          <span class="input-group-addon">E-mail</span>
          <input id="copyTargetEmail" readonly type="text" class="form-control" value="support@InvisaMage.com">
            <span class="input-group-btn">
              <a id="copyButtonEmail" roll="button" class="btn btn-light" href="javascript:emailMsg();" data-placement="top" data-toggle="tooltip" title="Copy Text" data-container="body">
                <i class="fa fa-clipboard" aria-hidden="true"></i>
              </a>
              <a roll="button" class="btn btn-light" href="mailto:support@invisamage.com" data-placement="top" data-toggle="tooltip" title="Send E-mail" data-container="body">
                <i class="fa fa-inbox" aria-hidden="true"></i>
              </a>
            </span>
        </div><!-- /input-group -->
        <!--Telegram-->
        <br>
        <div class="input-group">
          <div class="input-group-addon">Telegram</div>
          <input id="copyTargetTelegram" readonly type="text" class="form-control" value="https://telegram.me/InvisaMage">
            <span class="input-group-btn">
              <a id="copyButtonTelegram" roll="button" class="btn btn-light" href="javascript:telegramMsg();" data-placement="top" data-toggle="tooltip" title="Copy Text" data-container="body">
                <i class="fa fa-clipboard" aria-hidden="true"></i>
              </a>
              <a roll="button" class="btn btn-light" href="https://telegram.me/InvisaMage" target="_blank" rel="noopener noreferrer" data-placement="top" data-toggle="tooltip" title="Send Message" data-container="body">
                <i class="fa fa-telegram" aria-hidden="true"></i>
              </a>
            </span>
        </div><!-- /input-group -->
        <!--Keybase-->
        <br>
        <div class="input-group">
          <div class="input-group-addon">Keybase</div>
          <input id="copyTargetKeybase" readonly type="text" class="form-control" value="InvisaMage">
            <span class="input-group-btn">
              <a id="copyButtonKeybase" roll="button" class="btn btn-light" href="javascript:keybaseMsg();" data-placement="top" data-toggle="tooltip" title="Copy Text" data-container="body">
                <i class="fa fa-clipboard" aria-hidden="true"></i>
              </a>
              <a roll="button" class="btn btn-light" href="https://keybase.io/invisamage" target="_blank" rel="noopener noreferrer" data-placement="top" data-toggle="tooltip" title="View Profile" data-container="body">
                <i class="fa fa-user" aria-hidden="true"></i>
              </a>
            </span>
        </div><!-- /input-group -->
    </div>
    <!--Contact Help Collapsible Content-->
    <div class="collapse" id="modal-contact-collapse">
      <div class="card text-white bg-secondary">
        <h5 class="card-header">Help <button type="button" class="close" onclick="$('#modal-contact-collapse').collapse('toggle');" aria-label="Close"><span aria-hidden="true">&times;</span></button></h5>
        <div class="card-body">
          <h6>Explanation of contact methods</h6>
          <p class="card-text">
            <strong>E-mail</strong> - A method of exchanging digital messages from an author to one or more recipients.<br>
            <strong>Telegram</strong> - A cloud-based mobile and desktop messaging app with a focus on security and speed.<br>
            <strong>Keybase</strong> - Public key crypto for everyone, publicly auditable proofs of identity.
          </p>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-info" onclick="$('#modal-contact-collapse').collapse('toggle')">
        <i class="fa fa-question-circle" aria-hidden="true"></i>
      </button>
      <button type="button" class="btn btn-primary" data-dismiss="modal"> Done
        <i class="fa fa-check" aria-hidden="true"></i>
      </button>
    </div>
  </div>
</div><!-- /.modal-contact-->

<script>
  $(function() {
    settings.getItem('theme').then(function(value) {
      if (value == 'light') {
        $('.btn.btn-light').removeClass('btn-light').addClass('btn-secondary');
        $('.card.bg-secondary').removeClass('bg-secondary').addClass('bg-light');
      }
    });
  });

//Email Copy Function
      document.getElementById("copyButtonEmail").addEventListener("click", function() {
      copyToClipboard(document.getElementById("copyTargetEmail"));
  });

  function copyToClipboard(elem) {
  	  // create hidden text element, if it doesn't already exist
      var targetId = "_hiddenCopyText_";
      var isInput = elem.tagName === "INPUT" || elem.tagName === "TEXTAREA";
      var origSelectionStart, origSelectionEnd;
      if (isInput) {
          // can just use the original source element for the selection and copy
          target = elem;
          origSelectionStart = elem.selectionStart;
          origSelectionEnd = elem.selectionEnd;
      } else {
          // must use a temporary form element for the selection and copy
          target = document.getElementById(targetId);
          if (!target) {
              var target = document.createElement("textarea");
              target.style.position = "absolute";
              target.style.left = "-9999px";
              target.style.top = "0";
              target.id = targetId;
              document.body.appendChild(target);
          }
          target.textContent = elem.textContent;
      }
      // select the content
      var currentFocus = document.activeElement;
      target.focus();
      target.setSelectionRange(0, target.value.length);

      // copy the selection
      var succeed;
      try {
      	  succeed = document.execCommand("copy");
      } catch(e) {
          succeed = false;
      }
      // restore original focus
      if (currentFocus && typeof currentFocus.focus === "function") {
          currentFocus.focus();
      }

      if (isInput) {
          // restore prior selection
          elem.setSelectionRange(origSelectionStart, origSelectionEnd);
      } else {
          // clear temporary content
          target.textContent = "";
      }
      return succeed;
  }

//Telegram Copy Function
      document.getElementById("copyButtonTelegram").addEventListener("click", function() {
      copyToClipboard(document.getElementById("copyTargetTelegram"));
  });

  function copyToClipboard(elem) {
  	  // create hidden text element, if it doesn't already exist
      var targetId = "_hiddenCopyText_";
      var isInput = elem.tagName === "INPUT" || elem.tagName === "TEXTAREA";
      var origSelectionStart, origSelectionEnd;
      if (isInput) {
          // can just use the original source element for the selection and copy
          target = elem;
          origSelectionStart = elem.selectionStart;
          origSelectionEnd = elem.selectionEnd;
      } else {
          // must use a temporary form element for the selection and copy
          target = document.getElementById(targetId);
          if (!target) {
              var target = document.createElement("textarea");
              target.style.position = "absolute";
              target.style.left = "-9999px";
              target.style.top = "0";
              target.id = targetId;
              document.body.appendChild(target);
          }
          target.textContent = elem.textContent;
      }
      // select the content
      var currentFocus = document.activeElement;
      target.focus();
      target.setSelectionRange(0, target.value.length);

      // copy the selection
      var succeed;
      try {
      	  succeed = document.execCommand("copy");
      } catch(e) {
          succeed = false;
      }
      // restore original focus
      if (currentFocus && typeof currentFocus.focus === "function") {
          currentFocus.focus();
      }

      if (isInput) {
          // restore prior selection
          elem.setSelectionRange(origSelectionStart, origSelectionEnd);
      } else {
          // clear temporary content
          target.textContent = "";
      }
      return succeed;
  }

//Keybase Copy Function
      document.getElementById("copyButtonKeybase").addEventListener("click", function() {
      copyToClipboard(document.getElementById("copyTargetKeybase"));
  });

  function copyToClipboard(elem) {
  	  // create hidden text element, if it doesn't already exist
      var targetId = "_hiddenCopyText_";
      var isInput = elem.tagName === "INPUT" || elem.tagName === "TEXTAREA";
      var origSelectionStart, origSelectionEnd;
      if (isInput) {
          // can just use the original source element for the selection and copy
          target = elem;
          origSelectionStart = elem.selectionStart;
          origSelectionEnd = elem.selectionEnd;
      } else {
          // must use a temporary form element for the selection and copy
          target = document.getElementById(targetId);
          if (!target) {
              var target = document.createElement("textarea");
              target.style.position = "absolute";
              target.style.left = "-9999px";
              target.style.top = "0";
              target.id = targetId;
              document.body.appendChild(target);
          }
          target.textContent = elem.textContent;
      }
      // select the content
      var currentFocus = document.activeElement;
      target.focus();
      target.setSelectionRange(0, target.value.length);

      // copy the selection
      var succeed;
      try {
      	  succeed = document.execCommand("copy");
      } catch(e) {
          succeed = false;
      }
      // restore original focus
      if (currentFocus && typeof currentFocus.focus === "function") {
          currentFocus.focus();
      }

      if (isInput) {
          // restore prior selection
          elem.setSelectionRange(origSelectionStart, origSelectionEnd);
      } else {
          // clear temporary content
          target.textContent = "";
      }
      return succeed;
  }

  //Contact modal copy messages
  function emailMsg() {
      $.bootstrapGrowl("E-mail address copied!", {
        type: 'success',
        align: 'right',
        offset: {from: 'top', amount: 70},
        width: 'auto',
        allow_dismiss: true
      });
  }
  function telegramMsg() {
      $.bootstrapGrowl("Telegram URL copied!", {
        type: 'success',
        align: 'right',
        offset: {from: 'top', amount: 70},
        width: 'auto',
        allow_dismiss: true
      });
  }
  function keybaseMsg() {
      $.bootstrapGrowl("Keybase username copied!", {
        type: 'success',
        align: 'right',
        offset: {from: 'top', amount: 70},
        width: 'auto',
        allow_dismiss: true
      });
  }

  //Re enable tooltips.
  if(!('ontouchstart' in window))
  {
    $('[data-toggle="tooltip"]').tooltip();
  }
</script>
