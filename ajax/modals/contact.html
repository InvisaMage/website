<!DOCTYPE html>

<!--Contact Modal-->
<div class="modal-dialog modal-md" id="ajax-contact" role="document">
  <div class="modal-content">
    <div class="modal-header">
       <h4 class="modal-title">Contact</h4>
      <button type="button" class="close" data-dismiss="modal">
          <span>&times;</span>
      </button>
    </div>
    <div class="modal-body">
      Questions, Comments, Suggestions, <a class="link" href="fs.html">Floating Survival</a> problems?
      <br>
      <br>
        <!--E-mail-->
        <div class="input-group">
          <div class="input-group-prepend">
            <div class="input-group-text">E-mail</div>
          </div>
          <input id="copyTargetEmail" readonly type="text" class="form-control" value="support@InvisaMage.com">
          <div class="input-group-append">
            <a id="copyButtonEmail" roll="button" class="btn btn-light" href="javascript:emailMsg();" data-placement="top" data-toggle="tooltip" title="Copy text" data-container="body">
              <i class="far fa-copy"></i>
            </a>
            <a roll="button" class="btn btn-light" href="mailto:support@invisamage.com" data-placement="top" data-toggle="tooltip" title="Send e-mail" data-container="body">
              <i class="far fa-envelope-open"></i>
            </a>
          </div>
        </div><!-- /input-group -->
        <br>
        <!--Telegram-->
        <div class="input-group">
          <div class="input-group-prepend">
            <div class="input-group-text">Telegram</div>
          </div>
          <input id="copyTargetTelegram" readonly type="text" class="form-control" value="https://telegram.me/InvisaMage">
          <div class="input-group-append">
            <a id="copyButtonTelegram" roll="button" class="btn btn-light" href="javascript:telegramMsg();" data-placement="top" data-toggle="tooltip" title="Copy text" data-container="body">
              <i class="far fa-copy"></i>
            </a>
            <a roll="button" class="btn btn-light" href="https://telegram.me/InvisaMage" target="_blank" rel="noopener noreferrer" data-placement="top" data-toggle="tooltip" title="Send message" data-container="body">
              <i class="fab fa-telegram-plane"></i>
            </a>
          </div>
        </div><!-- /input-group -->
        <br>
        <!--Keybase-->
        <div class="input-group">
          <div class="input-group-prepend">
            <div class="input-group-text">Keybase</div>
          </div>
          <input id="copyTargetKeybase" readonly type="text" class="form-control" value="InvisaMage">
          <div class="input-group-append">
            <a id="copyButtonKeybase" roll="button" class="btn btn-light" href="javascript:keybaseMsg();" data-placement="top" data-toggle="tooltip" title="Copy text" data-container="body">
              <i class="far fa-copy"></i>
            </a>
            <a roll="button" class="btn btn-light" href="https://keybase.io/invisamage" target="_blank" rel="noopener noreferrer" data-placement="top" data-toggle="tooltip" title="View profile" data-container="body">
              <i class="far fa-user"></i>
            </a>
          </div>
        </div><!-- /input-group -->
    </div>
    <!--Contact Help Collapsible Content-->
    <div class="collapse" id="modal-contact-collapse">
      <div class="card text-white bg-secondary">
        <h5 class="card-header">Help <button type="button" class="close" onclick="$('#modal-contact-collapse').collapse('toggle');"><span>&times;</span></button></h5>
        <div class="card-body">
          <h6>Explanation of contact methods</h6>
          <p class="card-text">
            <strong>E-mail</strong> - A method of exchanging digital messages from an author to one or more recipients.<br>
            <strong>Telegram</strong> - A cloud-based mobile and desktop messaging app with a focus on security and speed.<br>
            <strong>Keybase</strong> - Public key crypto for everyone, publicly auditable proofs of identity.
          </p>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-info" onclick="$('#modal-contact-collapse').collapse('toggle')">
        <i class="fa fa-question-circle"></i>
      </button>
      <button type="button" class="btn btn-primary" data-dismiss="modal"> Done
        <i class="fa fa-check"></i>
      </button>
    </div>
  </div>
</div><!-- /.modal-contact-->

<script>
  $(function() {
    settings.getItem('theme').then(function(value) {
      if (value == 'light') {
        $('.btn.btn-light').removeClass('btn-light').addClass('btn-secondary');
        $('.card.bg-secondary').removeClass('bg-secondary').addClass('border-dark');
      }
    });
    settings.getItem('centeredModals').then(function(value) {
      if (value == 'true') {
        $('.modal-dialog').addClass('modal-dialog-centered');
      }
      console.log('centeredModals = ' + value);
    });
  });

//Email Copy Function
      document.getElementById("copyButtonEmail").addEventListener("click", function() {
      copyToClipboard(document.getElementById("copyTargetEmail"));
  });

  function copyToClipboard(elem) {
  	  // create hidden text element, if it doesn't already exist
      var targetId = "_hiddenCopyText_";
      var isInput = elem.tagName === "INPUT" || elem.tagName === "TEXTAREA";
      var origSelectionStart, origSelectionEnd;
      if (isInput) {
          // can just use the original source element for the selection and copy
          target = elem;
          origSelectionStart = elem.selectionStart;
          origSelectionEnd = elem.selectionEnd;
      } else {
          // must use a temporary form element for the selection and copy
          target = document.getElementById(targetId);
          if (!target) {
              var target = document.createElement("textarea");
              target.style.position = "absolute";
              target.style.left = "-9999px";
              target.style.top = "0";
              target.id = targetId;
              document.body.appendChild(target);
          }
          target.textContent = elem.textContent;
      }
      // select the content
      var currentFocus = document.activeElement;
      target.focus();
      target.setSelectionRange(0, target.value.length);

      // copy the selection
      var succeed;
      try {
      	  succeed = document.execCommand("copy");
      } catch(e) {
          succeed = false;
      }
      // restore original focus
      if (currentFocus && typeof currentFocus.focus === "function") {
          currentFocus.focus();
      }

      if (isInput) {
          // restore prior selection
          elem.setSelectionRange(origSelectionStart, origSelectionEnd);
      } else {
          // clear temporary content
          target.textContent = "";
      }
      return succeed;
  }

//Telegram Copy Function
      document.getElementById("copyButtonTelegram").addEventListener("click", function() {
      copyToClipboard(document.getElementById("copyTargetTelegram"));
  });

  function copyToClipboard(elem) {
  	  // create hidden text element, if it doesn't already exist
      var targetId = "_hiddenCopyText_";
      var isInput = elem.tagName === "INPUT" || elem.tagName === "TEXTAREA";
      var origSelectionStart, origSelectionEnd;
      if (isInput) {
          // can just use the original source element for the selection and copy
          target = elem;
          origSelectionStart = elem.selectionStart;
          origSelectionEnd = elem.selectionEnd;
      } else {
          // must use a temporary form element for the selection and copy
          target = document.getElementById(targetId);
          if (!target) {
              var target = document.createElement("textarea");
              target.style.position = "absolute";
              target.style.left = "-9999px";
              target.style.top = "0";
              target.id = targetId;
              document.body.appendChild(target);
          }
          target.textContent = elem.textContent;
      }
      // select the content
      var currentFocus = document.activeElement;
      target.focus();
      target.setSelectionRange(0, target.value.length);

      // copy the selection
      var succeed;
      try {
      	  succeed = document.execCommand("copy");
      } catch(e) {
          succeed = false;
      }
      // restore original focus
      if (currentFocus && typeof currentFocus.focus === "function") {
          currentFocus.focus();
      }

      if (isInput) {
          // restore prior selection
          elem.setSelectionRange(origSelectionStart, origSelectionEnd);
      } else {
          // clear temporary content
          target.textContent = "";
      }
      return succeed;
  }

//Keybase Copy Function
      document.getElementById("copyButtonKeybase").addEventListener("click", function() {
      copyToClipboard(document.getElementById("copyTargetKeybase"));
  });

  function copyToClipboard(elem) {
  	  // create hidden text element, if it doesn't already exist
      var targetId = "_hiddenCopyText_";
      var isInput = elem.tagName === "INPUT" || elem.tagName === "TEXTAREA";
      var origSelectionStart, origSelectionEnd;
      if (isInput) {
          // can just use the original source element for the selection and copy
          target = elem;
          origSelectionStart = elem.selectionStart;
          origSelectionEnd = elem.selectionEnd;
      } else {
          // must use a temporary form element for the selection and copy
          target = document.getElementById(targetId);
          if (!target) {
              var target = document.createElement("textarea");
              target.style.position = "absolute";
              target.style.left = "-9999px";
              target.style.top = "0";
              target.id = targetId;
              document.body.appendChild(target);
          }
          target.textContent = elem.textContent;
      }
      // select the content
      var currentFocus = document.activeElement;
      target.focus();
      target.setSelectionRange(0, target.value.length);

      // copy the selection
      var succeed;
      try {
      	  succeed = document.execCommand("copy");
      } catch(e) {
          succeed = false;
      }
      // restore original focus
      if (currentFocus && typeof currentFocus.focus === "function") {
          currentFocus.focus();
      }

      if (isInput) {
          // restore prior selection
          elem.setSelectionRange(origSelectionStart, origSelectionEnd);
      } else {
          // clear temporary content
          target.textContent = "";
      }
      return succeed;
  }

  //Contact modal copy messages
  function emailMsg() {
    PNotify.success({
      text: 'E-mail address copied!'
    });
  }
  function telegramMsg() {
    PNotify.success({
      text: 'Telegram URL copied!'
    });
  }
  function keybaseMsg() {
    PNotify.success({
      text: 'Keybase username copied!'
    });
  }

  enableTooltips();
</script>
